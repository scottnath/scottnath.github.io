<!DOCTYPE html><html lang="en-US"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/favicon-mind-blown.ico" id="favicon"><meta http-equiv="content-language" content="en-us"><link rel="sitemap" href="/sitemap-index.xml"><meta name="generator" content="Macromedia Dreamweaver 6.0"><link rel="preload" as="image" href="/blahg-assets/js-framework-share-tests.avif"><link rel="alternate" type="application/rss+xml" title="Blah blah blahg by Scott Nath, Articles and rambling-on by Scott Nath" href="https://scottnath.com/rss.xml"><!-- Canonical URL --><link rel="canonical" href="https://scottnath.com/blahg/sharing-tests-between-javascript-frameworks/"><!-- Primary Meta Tags --><title>Sharing UI Tests Between Javascript Frameworks</title><meta name="title" content="Sharing UI Tests Between Javascript Frameworks"><meta name="description" content="How to share testing-library UI tests between Javascript frameworks with the same or similar components and use them in Storybook and unit testing."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://scottnath.com/blahg/sharing-tests-between-javascript-frameworks/"><meta property="og:title" content="Sharing UI Tests Between Javascript Frameworks"><meta property="og:description" content="How to share testing-library UI tests between Javascript frameworks with the same or similar components and use them in Storybook and unit testing."><meta property="og:image" content="https://scottnath.com/blahg-assets/js-framework-share-tests.avif"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://scottnath.com/blahg/sharing-tests-between-javascript-frameworks/"><meta property="twitter:title" content="Sharing UI Tests Between Javascript Frameworks"><meta property="twitter:description" content="How to share testing-library UI tests between Javascript frameworks with the same or similar components and use them in Storybook and unit testing."><meta property="twitter:image" content="https://scottnath.com/blahg-assets/js-framework-share-tests.avif"><script defer data-domain="scottnath.com" src="https://plausible.io/js/script.js" type="text/partytown"></script><script defer data-domain="scottnath.com" src="https://plausible.io/js/script.outbound-links.js" type="text/partytown"></script><link rel="stylesheet" href="/_astro/_slug_.BwqpPIKv.css"><script type="module">const e=()=>{const i=document.querySelector("#favicon");if(document.hidden){const n=i?.href;document.initialFavicon=n,i.href="/favicon-clown.ico"}else document.initialFavicon!==""&&(i.href=document.initialFavicon)};document.addEventListener("visibilitychange",e,!0);document.initialFavicon=document.querySelector("#favicon").href;
</script>
<script>/** @license Copyright 2020 Google LLC (BSD-3-Clause) */
/** Bundled JS generated from "@astrojs/lit/client-shim.js" */
var N = Object.defineProperty;
var i = (t, n) => () => (t && (n = t((t = 0))), n);
var b = (t, n) => {
	for (var a in n) N(t, a, { get: n[a], enumerable: !0 });
};
function s() {
	if (d === void 0) {
		let t = document.createElement('div');
		(t.innerHTML = '<div><template shadowroot="open" shadowrootmode="open"></template></div>'),
			(d = !!t.firstElementChild.shadowRoot);
	}
	return d;
}
var d,
	m = i(() => {});
var p,
	c,
	f,
	u = i(() => {
		(p = (t) => t.parentElement === null),
			(c = (t) => t.tagName === 'TEMPLATE'),
			(f = (t) => t.nodeType === Node.ELEMENT_NODE);
	});
var h,
	E = i(() => {
		m();
		u();
		h = (t) => {
			var n;
			if (s()) return;
			let a = [],
				e = t.firstElementChild;
			for (; e !== t && e !== null; )
				if (c(e)) a.push(e), (e = e.content);
				else if (e.firstElementChild !== null) e = e.firstElementChild;
				else if (f(e) && e.nextElementSibling !== null) e = e.nextElementSibling;
				else {
					let o;
					for (; e !== t && e !== null; )
						if (p(e)) {
							o = a.pop();
							let r = o.parentElement,
								l = o.getAttribute('shadowroot');
							if (((e = o), l === 'open' || l === 'closed')) {
								let y = o.hasAttribute('shadowrootdelegatesfocus');
								try {
									r.attachShadow({ mode: l, delegatesFocus: y }).append(o.content);
								} catch {}
							} else o = void 0;
						} else {
							let r = e.nextElementSibling;
							if (r != null) {
								(e = r), o !== void 0 && o.parentElement.removeChild(o);
								break;
							}
							let l =
								(n = e.parentElement) === null || n === void 0 ? void 0 : n.nextElementSibling;
							if (l != null) {
								(e = l), o !== void 0 && o.parentElement.removeChild(o);
								break;
							}
							(e = e.parentElement), o !== void 0 && (o.parentElement.removeChild(o), (o = void 0));
						}
				}
		};
	});
var w = i(() => {
	E();
});
var v = {};
b(v, { hasNativeDeclarativeShadowRoots: () => s, hydrateShadowRoots: () => h });
var S = i(() => {
	m();
	w();
});
async function g() {
	let { hydrateShadowRoots: t } = await Promise.resolve().then(() => (S(), v));
	window.addEventListener('DOMContentLoaded', () => t(document.body), { once: true });
}
var x = new DOMParser()
	.parseFromString(
		'<p><template shadowroot="open" shadowrootmode="open"></template></p>',
		'text/html',
		{
			includeShadowRoots: !0,
		}
	)
	.querySelector('p');
(!x || !x.shadowRoot) && g();
</script>
<script>!(function(w,p,f,c){if(!window.crossOriginIsolated && !navigator.serviceWorker) return;c=w[p]=Object.assign(w[p]||{},{"lib":"/~partytown/","debug":false});c[f]=(c[f]||[]).concat(["dataLayer.push"])})(window,'partytown','forward');/* Partytown 0.8.2 - MIT builder.io */
!function(t,e,n,i,o,r,a,s,d,c,l,p){function u(){p||(p=1,"/"==(a=(r.lib||"/~partytown/")+(r.debug?"debug/":""))[0]&&(d=e.querySelectorAll('script[type="text/partytown"]'),i!=t?i.dispatchEvent(new CustomEvent("pt1",{detail:t})):(s=setTimeout(f,1e4),e.addEventListener("pt0",w),o?h(1):n.serviceWorker?n.serviceWorker.register(a+(r.swPath||"partytown-sw.js"),{scope:a}).then((function(t){t.active?h():t.installing&&t.installing.addEventListener("statechange",(function(t){"activated"==t.target.state&&h()}))}),console.error):f())))}function h(t){c=e.createElement(t?"script":"iframe"),t||(c.style.display="block",c.style.width="0",c.style.height="0",c.style.border="0",c.style.visibility="hidden",c.setAttribute("aria-hidden",!0)),c.src=a+"partytown-"+(t?"atomics.js?v=0.8.2":"sandbox-sw.html?"+Date.now()),e.querySelector(r.sandboxParent||"body").appendChild(c)}function f(n,o){for(w(),i==t&&(r.forward||[]).map((function(e){delete t[e.split(".")[0]]})),n=0;n<d.length;n++)(o=e.createElement("script")).innerHTML=d[n].innerHTML,o.nonce=r.nonce,e.head.appendChild(o);c&&c.parentNode.removeChild(c)}function w(){clearTimeout(s)}r=t.partytown||{},i==t&&(r.forward||[]).map((function(e){l=t,e.split(".").map((function(e,n,i){l=l[i[n]]=n+1<i.length?"push"==i[n+1]?[]:l[i[n]]||{}:function(){(t._ptf=t._ptf||[]).push(i,arguments)}}))})),"complete"==e.readyState?u():(t.addEventListener("DOMContentLoaded",u),t.addEventListener("load",u))}(window,document,navigator,top,window.crossOriginIsolated);;((d,s)=>(s=d.currentScript,d.addEventListener('astro:before-swap',()=>s.remove(),{once:true})))(document);</script></head> <body> <a href="#main" id="skip-to-main">Skip to main content</a> <header data-astro-cid-3ef6ksr2> <h2 data-astro-cid-3ef6ksr2> <span class="name" data-astro-cid-3ef6ksr2>Scott Nath</span> <span class="title" data-astro-cid-3ef6ksr2>Frontend Architect</span> </h2> <nav data-astro-cid-2hp2wczs> <dope-stripes data-astro-cid-2hp2wczs="true"><template shadowroot="open" shadowrootmode="open"><style>:host{display:block;position:relative;--angle-x-start: 35%;--angle-width: 5%;--angle-y-end: 40px;--stripe-height: 16px;--stripe-color: #ffe27a;width:100%;min-height:var(--stripe-height)}::slotted(dope-stripe),dope-stripe{--no-top-margin: -1}dope-stripe:first-child{--no-top-margin: 0}.stripes:not(:has(dope-stripe)) ::slotted(dope-stripe:first-child){--no-top-margin: 0}</style><!--lit-part grV36YUwDSo=--><div class="stripes" part="stripes" exportparts="stripe">
      <!--lit-part--><!--/lit-part-->
      <slot></slot>
  </div><!--/lit-part--></template> <dope-stripe defer-hydration data-astro-cid-2hp2wczs="true"><template shadowroot="open" shadowrootmode="open"><style>
    :host {
      --angle-x-start: 35%;
      --angle-width: 5%;
      --angle-y-end: 40px;
      --stripe-height: 16px;
      --stripe-color:#ffe27a;
      --top-margin: var(--no-top-margin, 0);

      --angle-x-end: calc(var(--angle-x-start) + var(--angle-width));
      --stripe-box-height: calc(var(--angle-y-end) + var(--stripe-height));
      --angle-y-right-bottom: calc(var(--angle-y-end) + var(--stripe-height));

      --polygon-path: 
        0 0, 
        var(--angle-x-start) 0, 
        var(--angle-x-end) var(--angle-y-end), 
        100% var(--angle-y-end), 
        100% var(--stripe-box-height), 
        var(--angle-x-end) var(--stripe-box-height), 
        var(--angle-x-start) var(--stripe-height), 
        0 var(--stripe-height);

      width: 100%;
      position: relative;
      display: block;
      margin-top: calc((var(--angle-y-end) + 1px) * var(--top-margin));
      clip-path: polygon(var(--polygon-path));
    }

    [part=stripe] {
      background-color: var(--stripe-color);
      width: 100%;
      height: var(--stripe-box-height);
      position: relative;
    }
  </style><!--lit-part 2hRJq3MaOiM=--><!--lit-node 0--><div part="stripe" style="--stripe-color: #ffd273"><slot></slot></div><!--/lit-part--></template> <a href="/" data-astro-cid-2hp2wczs data-astro-cid-eimmu3lg> <span data-astro-cid-2hp2wczs>home</span> </a>  </dope-stripe> <dope-stripe defer-hydration data-astro-cid-2hp2wczs="true"><template shadowroot="open" shadowrootmode="open"><style>
    :host {
      --angle-x-start: 35%;
      --angle-width: 5%;
      --angle-y-end: 40px;
      --stripe-height: 16px;
      --stripe-color:#ffe27a;
      --top-margin: var(--no-top-margin, 0);

      --angle-x-end: calc(var(--angle-x-start) + var(--angle-width));
      --stripe-box-height: calc(var(--angle-y-end) + var(--stripe-height));
      --angle-y-right-bottom: calc(var(--angle-y-end) + var(--stripe-height));

      --polygon-path: 
        0 0, 
        var(--angle-x-start) 0, 
        var(--angle-x-end) var(--angle-y-end), 
        100% var(--angle-y-end), 
        100% var(--stripe-box-height), 
        var(--angle-x-end) var(--stripe-box-height), 
        var(--angle-x-start) var(--stripe-height), 
        0 var(--stripe-height);

      width: 100%;
      position: relative;
      display: block;
      margin-top: calc((var(--angle-y-end) + 1px) * var(--top-margin));
      clip-path: polygon(var(--polygon-path));
    }

    [part=stripe] {
      background-color: var(--stripe-color);
      width: 100%;
      height: var(--stripe-box-height);
      position: relative;
    }
  </style><!--lit-part 2hRJq3MaOiM=--><!--lit-node 0--><div part="stripe" style="--stripe-color: #ffbf57"><slot></slot></div><!--/lit-part--></template> <a href="/whoami" data-astro-cid-2hp2wczs data-astro-cid-eimmu3lg> <span data-astro-cid-2hp2wczs>whoami</span> </a>  </dope-stripe> <dope-stripe defer-hydration data-astro-cid-2hp2wczs="true"><template shadowroot="open" shadowrootmode="open"><style>
    :host {
      --angle-x-start: 35%;
      --angle-width: 5%;
      --angle-y-end: 40px;
      --stripe-height: 16px;
      --stripe-color:#ffe27a;
      --top-margin: var(--no-top-margin, 0);

      --angle-x-end: calc(var(--angle-x-start) + var(--angle-width));
      --stripe-box-height: calc(var(--angle-y-end) + var(--stripe-height));
      --angle-y-right-bottom: calc(var(--angle-y-end) + var(--stripe-height));

      --polygon-path: 
        0 0, 
        var(--angle-x-start) 0, 
        var(--angle-x-end) var(--angle-y-end), 
        100% var(--angle-y-end), 
        100% var(--stripe-box-height), 
        var(--angle-x-end) var(--stripe-box-height), 
        var(--angle-x-start) var(--stripe-height), 
        0 var(--stripe-height);

      width: 100%;
      position: relative;
      display: block;
      margin-top: calc((var(--angle-y-end) + 1px) * var(--top-margin));
      clip-path: polygon(var(--polygon-path));
    }

    [part=stripe] {
      background-color: var(--stripe-color);
      width: 100%;
      height: var(--stripe-box-height);
      position: relative;
    }
  </style><!--lit-part 2hRJq3MaOiM=--><!--lit-node 0--><div part="stripe" style="--stripe-color: #ffa43b"><slot></slot></div><!--/lit-part--></template> <a href="/blahg" class="active" data-astro-cid-2hp2wczs data-astro-cid-eimmu3lg> <span data-astro-cid-2hp2wczs>blahg</span> </a>  </dope-stripe> <dope-stripe defer-hydration data-astro-cid-2hp2wczs="true"><template shadowroot="open" shadowrootmode="open"><style>
    :host {
      --angle-x-start: 35%;
      --angle-width: 5%;
      --angle-y-end: 40px;
      --stripe-height: 16px;
      --stripe-color:#ffe27a;
      --top-margin: var(--no-top-margin, 0);

      --angle-x-end: calc(var(--angle-x-start) + var(--angle-width));
      --stripe-box-height: calc(var(--angle-y-end) + var(--stripe-height));
      --angle-y-right-bottom: calc(var(--angle-y-end) + var(--stripe-height));

      --polygon-path: 
        0 0, 
        var(--angle-x-start) 0, 
        var(--angle-x-end) var(--angle-y-end), 
        100% var(--angle-y-end), 
        100% var(--stripe-box-height), 
        var(--angle-x-end) var(--stripe-box-height), 
        var(--angle-x-start) var(--stripe-height), 
        0 var(--stripe-height);

      width: 100%;
      position: relative;
      display: block;
      margin-top: calc((var(--angle-y-end) + 1px) * var(--top-margin));
      clip-path: polygon(var(--polygon-path));
    }

    [part=stripe] {
      background-color: var(--stripe-color);
      width: 100%;
      height: var(--stripe-box-height);
      position: relative;
    }
  </style><!--lit-part 2hRJq3MaOiM=--><!--lit-node 0--><div part="stripe" style="--stripe-color: #ff8920"><slot></slot></div><!--/lit-part--></template> <a href="/resume" data-astro-cid-2hp2wczs data-astro-cid-eimmu3lg> <span data-astro-cid-2hp2wczs>resume</span> </a>  </dope-stripe> <dope-stripe defer-hydration data-astro-cid-2hp2wczs="true"><template shadowroot="open" shadowrootmode="open"><style>
    :host {
      --angle-x-start: 35%;
      --angle-width: 5%;
      --angle-y-end: 40px;
      --stripe-height: 16px;
      --stripe-color:#ffe27a;
      --top-margin: var(--no-top-margin, 0);

      --angle-x-end: calc(var(--angle-x-start) + var(--angle-width));
      --stripe-box-height: calc(var(--angle-y-end) + var(--stripe-height));
      --angle-y-right-bottom: calc(var(--angle-y-end) + var(--stripe-height));

      --polygon-path: 
        0 0, 
        var(--angle-x-start) 0, 
        var(--angle-x-end) var(--angle-y-end), 
        100% var(--angle-y-end), 
        100% var(--stripe-box-height), 
        var(--angle-x-end) var(--stripe-box-height), 
        var(--angle-x-start) var(--stripe-height), 
        0 var(--stripe-height);

      width: 100%;
      position: relative;
      display: block;
      margin-top: calc((var(--angle-y-end) + 1px) * var(--top-margin));
      clip-path: polygon(var(--polygon-path));
    }

    [part=stripe] {
      background-color: var(--stripe-color);
      width: 100%;
      height: var(--stripe-box-height);
      position: relative;
    }
  </style><!--lit-part 2hRJq3MaOiM=--><!--lit-node 0--><div part="stripe" style="--stripe-color: #ff6e05"><slot></slot></div><!--/lit-part--></template></dope-stripe> </dope-stripes> </nav>  <img src="/scott-nath-profile-photo.avif" alt="Scott Nath's picture" width="400" height="400" class="avatar" data-astro-cid-3ef6ksr2> <address class="socials" aria-label="Also find me on these sites" data-astro-cid-6jz5wqfy> <a rel="me" href="https://github.com/scottnath" aria-label="Scott Nath on GitHub" data-astro-cid-6jz5wqfy><img src="/_astro/github-inverse.5c5sSg3g.svg" alt="GitHub logo" aria-hidden="true" data-astro-cid-6jz5wqfy><span data-astro-cid-6jz5wqfy>GitHub</span></a><a rel="me" href="https://dev.to/scottnath" aria-label="Scott Nath's articles on dev.to" data-astro-cid-6jz5wqfy><img src="/_astro/dev.DPyAJ8Ri.svg" alt="dev.to logo" aria-hidden="true" data-astro-cid-6jz5wqfy><span data-astro-cid-6jz5wqfy>dev.to</span></a><a rel="me" href="https://linkedin.com/in/scottnath" aria-label="Connect with Scott Nath on LinkedIn" data-astro-cid-6jz5wqfy><img src="/_astro/linkedin.C92OM-O6.svg" alt="LinkedIn logo" aria-hidden="true" data-astro-cid-6jz5wqfy><span data-astro-cid-6jz5wqfy>LinkedIn</span></a><a rel="me" href="https://mastodon.social/@scottnath" aria-label="Read Scott Nath blah on Mastodon" data-astro-cid-6jz5wqfy><img src="/_astro/Mastodon.QaBq5b1c.svg" alt="Mastodon logo" aria-hidden="true" data-astro-cid-6jz5wqfy><span data-astro-cid-6jz5wqfy>Mastodon</span></a> </address>  </header>  <main id="main">  <article class="blog-post" itemscope itemtype="https://schema.org/TechArticle"> <header> <img width="100%" height="auto" src="/blahg-assets/js-framework-share-tests.avif" alt="Header image for article 'Sharing UI Tests Between Javascript Frameworks'"> <h1 class="title" itemprop="name">Sharing UI Tests Between Javascript Frameworks</h1> <p itemprop="description">How to share testing-library UI tests between Javascript frameworks with the same or similar components and use them in Storybook and unit testing.</p> <dl class="article-dates"> <div> <dt>Published</dt> <dd><time datetime="2023-06-27T00:00:00.000Z" itemprop="datePublished"> Jun 27, 2023 </time></dd> </div>  </dl> </header> <hr> <div class="readable" itemprop="articleBody"> <p>How to share testing-library UI tests between Javascript frameworks with the same or similar components and use them in Storybook and unit testing.</p>
<h2 id="tldr">tl;dr</h2>
<p>Tests can be shared between Javascript components which have a similar HTML structure and/or a similar UX. The same shared tests can be used in both Storybook’s <code>play</code> tests (Interaction testing) and Vitest unit tests.</p>
<ul>
<li><a href="https://github.com/storydocker/storydocker-examples/tree/main/experimental/astro-framework-multiple">working example on github</a></li>
<li><a href="https://storydocker.github.io/storydocker-examples/astro-framework-multiple/?path=/story/astro--astro">live Storybook with working play tests</a></li>
</ul>
<details>
<summary>Prerequisite knowledge</summary>
<ul>
<li><a href="https://storybook.js.org/docs/react/writing-tests/interaction-testing">Storybook interactive tests</a></li>
<li><a href="https://testing-library.com/">Testing Library</a></li>
</ul>
</details>
<h2 id="why-share-tests-between-javascript-frameworks">Why share tests between Javascript Frameworks?</h2>
<ul>
<li>You have one or more applications which share UX, but which are built with different JS Frameworks</li>
<li>When converting an application from one JS Framework to another</li>
<li>Your company maintains a design system with multiple component libraries built with different JS Frameworks, but the same UX</li>
</ul>
<h2 id="shared-tests-and-how-to-use-them">Shared tests and how to use them</h2>
<p>Staying D.R.Y. so… dig through <a href="/blahg/shared-storybook-tests/">part 1 - “What are shared tests”</a>, <a href="/blahg/sharing-tests-between-components/">part 2 - “Sharing tests between components”</a>, and <a href="/blahg/sharing-tests-between-vitest-and-storybook/">part 3 - “Sharing tests between Vitest and Storybook”</a> to get the low-down on shared tests.</p>
<h2 id="why-does-this-work-are-you-a-wizard">Why does this work? Are you a wizard?</h2>
<p>As I’ve been writing this series, I realized it’s an ode to the magic of <a href="https://testing-library.com/">Testing Library</a>, which is built for testing UIs as a user would experience an app. This principle means <code>Testing Library</code> is not introduced to your UI until after it has already rendered…which means <code>Testing Library</code> is navigating a DOM just as a user would…and users do not know or care what framework you used to build your UI, just that it works as expected.</p>
<p><code>Testing Library</code> is the real MVP here.</p>
<h2 id="what-are-we-testing-this-time">What are we testing this time?</h2>
<p>This article shows a set of shared-tests for testing a Counter component rewritten across multiple Javascript frameworks. We’ll be using the components found in the <a href="https://astro.build/">Astro Web Framework</a>’s example: <a href="https://github.com/withastro/astro/tree/latest/examples/framework-multiple?on=github"><code>Kitchen Sink (Multiple Frameworks)</code></a>. These are written in Preact, React, Svelte, SolidJS, and Vue. This Astro microfrontend example is fantastic in that it demonstrates how the Astro Web Framework can have multiple Javascript frameworks running on the same page at the same time.</p>
<p>Fun fact! This is the codebase I used to demonstrate Storybook presenting multiple frameworks in the <a href="/blahg/multi-framework-composition-storybook-local/">DevOps for Multi-Framework Composition Storybooks series</a>.</p>
<h3 id="what-is-the-counter-component">What is the Counter component?</h3>
<p>The Counter component is a simple component which displays a number and has two buttons: one to increment the number and one to decrement the number. <strong>Each framework version has the exact same UX and HTML structure</strong>, with slight variations due to the syntax of the framework.</p>
<h4 id="html-for-preactcountertsx">HTML for PreactCounter.tsx:</h4>
<pre class="astro-code slack-dark" style="background-color:#222222;color:#E6E6E6; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#808080">&#x3C;</span><span style="color:#569CD6">div</span><span style="color:#9CDCFE"> class</span><span style="color:#E6E6E6">=</span><span style="color:#CE9178">"counter"</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">  &#x3C;</span><span style="color:#569CD6">button</span><span style="color:#9CDCFE"> onClick</span><span style="color:#E6E6E6">=</span><span style="color:#CE9178">{subtract}</span><span style="color:#808080">></span><span style="color:#E6E6E6">-</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">button</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">  &#x3C;</span><span style="color:#569CD6">pre</span><span style="color:#808080">></span><span style="color:#E6E6E6">{count}</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">pre</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">  &#x3C;</span><span style="color:#569CD6">button</span><span style="color:#9CDCFE"> onClick</span><span style="color:#E6E6E6">=</span><span style="color:#CE9178">{add}</span><span style="color:#808080">></span><span style="color:#E6E6E6">+</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">button</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">div</span><span style="color:#808080">></span></span>
<span class="line"></span></code></pre>
<h4 id="html-for-reactcountertsx">HTML for ReactCounter.tsx:</h4>
<pre class="astro-code slack-dark" style="background-color:#222222;color:#E6E6E6; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#808080">&#x3C;</span><span style="color:#569CD6">div</span><span style="color:#9CDCFE"> className</span><span style="color:#E6E6E6">=</span><span style="color:#CE9178">"counter"</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">  &#x3C;</span><span style="color:#569CD6">button</span><span style="color:#9CDCFE"> onClick</span><span style="color:#E6E6E6">=</span><span style="color:#CE9178">{subtract}</span><span style="color:#808080">></span><span style="color:#E6E6E6">-</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">button</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">  &#x3C;</span><span style="color:#569CD6">pre</span><span style="color:#808080">></span><span style="color:#E6E6E6">{count}</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">pre</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">  &#x3C;</span><span style="color:#569CD6">button</span><span style="color:#9CDCFE"> onClick</span><span style="color:#E6E6E6">=</span><span style="color:#CE9178">{add}</span><span style="color:#808080">></span><span style="color:#E6E6E6">+</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">button</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">div</span><span style="color:#808080">></span></span>
<span class="line"></span></code></pre>
<h4 id="html-for-sveltecountersvelte">HTML for SvelteCounter.svelte:</h4>
<pre class="astro-code slack-dark" style="background-color:#222222;color:#E6E6E6; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#808080">&#x3C;</span><span style="color:#569CD6">div</span><span style="color:#9CDCFE"> class</span><span style="color:#E6E6E6">=</span><span style="color:#CE9178">"counter"</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">  &#x3C;</span><span style="color:#569CD6">button</span><span style="color:#9CDCFE"> on:click</span><span style="color:#E6E6E6">=</span><span style="color:#CE9178">{subtract}</span><span style="color:#808080">></span><span style="color:#E6E6E6">-</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">button</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">  &#x3C;</span><span style="color:#569CD6">pre</span><span style="color:#808080">></span><span style="color:#E6E6E6">{count}</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">pre</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">  &#x3C;</span><span style="color:#569CD6">button</span><span style="color:#9CDCFE"> on:click</span><span style="color:#E6E6E6">=</span><span style="color:#CE9178">{add}</span><span style="color:#808080">></span><span style="color:#E6E6E6">+</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">button</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">div</span><span style="color:#808080">></span></span>
<span class="line"></span></code></pre>
<h4 id="html-for-vuecountervue">HTML for VueCounter.vue:</h4>
<pre class="astro-code slack-dark" style="background-color:#222222;color:#E6E6E6; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#808080">&#x3C;</span><span style="color:#569CD6">div</span><span style="color:#9CDCFE"> class</span><span style="color:#E6E6E6">=</span><span style="color:#CE9178">"counter"</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">  &#x3C;</span><span style="color:#569CD6">button</span><span style="color:#9CDCFE"> @click</span><span style="color:#E6E6E6">=</span><span style="color:#CE9178">"subtract()"</span><span style="color:#808080">></span><span style="color:#E6E6E6">-</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">button</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">  &#x3C;</span><span style="color:#569CD6">pre</span><span style="color:#808080">></span><span style="color:#E6E6E6">{{ count }}</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">pre</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">  &#x3C;</span><span style="color:#569CD6">button</span><span style="color:#9CDCFE"> @click</span><span style="color:#E6E6E6">=</span><span style="color:#CE9178">"add()"</span><span style="color:#808080">></span><span style="color:#E6E6E6">+</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">button</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">div</span><span style="color:#808080">></span></span>
<span class="line"></span></code></pre>
<h4 id="rendered-html-for-all-counter-components-is-the-same">Rendered HTML for all Counter components is the same</h4>
<p><em>All</em> components output the same HTML, which is the voodoo which makes this possible. Same HTML? Same tests.</p>
<pre class="astro-code slack-dark" style="background-color:#222222;color:#E6E6E6; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#808080">&#x3C;</span><span style="color:#569CD6">div</span><span style="color:#9CDCFE"> class</span><span style="color:#E6E6E6">=</span><span style="color:#CE9178">"counter"</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">  &#x3C;</span><span style="color:#569CD6">button</span><span style="color:#808080">></span><span style="color:#E6E6E6">-</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">button</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">  &#x3C;</span><span style="color:#569CD6">pre</span><span style="color:#808080">></span><span style="color:#E6E6E6">0</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">pre</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">  &#x3C;</span><span style="color:#569CD6">button</span><span style="color:#808080">></span><span style="color:#E6E6E6">+</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">button</span><span style="color:#808080">></span></span>
<span class="line"><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">div</span><span style="color:#808080">></span></span>
<span class="line"></span></code></pre>
<h2 id="the-shared-tests">The shared tests</h2>
<h3 id="1-getting-the-elements">1. Getting the elements</h3>
<p>The first step? Query the DOM for the elements we want to test.</p>
<p>We need:</p>
<ul>
<li>the <code>+</code> (<code>plus</code>) button</li>
<li>the <code>-</code> (<code>minus</code>) button</li>
<li>the <code>pre</code> element which contains the count</li>
<li>the container, which is a <code>div</code> with a class of <code>counter</code></li>
</ul>
<p>Using <code>Testing Library</code>’s queries, we’ll create an object by parsing the rendered HTML. In this method, <code>canvasElement</code> is the live DOM rendered by the framework.</p>
<pre class="astro-code slack-dark" style="background-color:#222222;color:#E6E6E6; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#C586C0">import</span><span style="color:#E6E6E6"> { </span><span style="color:#9CDCFE">within</span><span style="color:#E6E6E6"> } </span><span style="color:#C586C0">from</span><span style="color:#CE9178"> '@storybook/testing-library'</span><span style="color:#E6E6E6">;</span></span>
<span class="line"><span style="color:#6A9955">/**</span></span>
<span class="line"><span style="color:#6A9955"> * Extract elements from an HTMLElement</span></span>
<span class="line"><span style="color:#6A9955"> */</span></span>
<span class="line"><span style="color:#C586C0">export</span><span style="color:#569CD6"> const</span><span style="color:#DCDCAA"> getElements</span><span style="color:#D4D4D4"> =</span><span style="color:#569CD6"> async</span><span style="color:#E6E6E6"> (</span><span style="color:#9CDCFE">canvasElement</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">=></span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#6A9955">  // `within` adds the testing-library query methods</span></span>
<span class="line"><span style="color:#569CD6">  const</span><span style="color:#9CDCFE"> screen</span><span style="color:#D4D4D4"> =</span><span style="color:#DCDCAA"> within</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">canvasElement</span><span style="color:#E6E6E6">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C586C0">  return</span><span style="color:#E6E6E6"> { </span></span>
<span class="line"><span style="color:#9CDCFE">    screen</span><span style="color:#E6E6E6">,</span></span>
<span class="line"><span style="color:#9CDCFE">    canvasElement</span><span style="color:#E6E6E6">,</span></span>
<span class="line"><span style="color:#6A9955">    // `querySelector` used here to find the generic `div` container</span></span>
<span class="line"><span style="color:#9CDCFE">    container:</span><span style="color:#C586C0"> await</span><span style="color:#9CDCFE"> canvasElement</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">querySelector</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'.counter'</span><span style="color:#E6E6E6">),</span></span>
<span class="line"><span style="color:#6A9955">    // `queryByRole` finds each button, using `name` to search the text</span></span>
<span class="line"><span style="color:#9CDCFE">    minus:</span><span style="color:#C586C0"> await</span><span style="color:#9CDCFE"> screen</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">queryByRole</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'button'</span><span style="color:#E6E6E6">, { </span><span style="color:#9CDCFE">name:</span><span style="color:#D16969"> /-/</span><span style="color:#569CD6">i</span><span style="color:#E6E6E6"> }),</span></span>
<span class="line"><span style="color:#6A9955">    // using `queryBy` instead of `getBy` to avoid errors in `getElements`</span></span>
<span class="line"><span style="color:#9CDCFE">    plus:</span><span style="color:#C586C0"> await</span><span style="color:#9CDCFE"> screen</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">queryByRole</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'button'</span><span style="color:#E6E6E6">, { </span><span style="color:#9CDCFE">name:</span><span style="color:#D16969"> /</span><span style="color:#D7BA7D">\+</span><span style="color:#D16969">/</span><span style="color:#569CD6">i</span><span style="color:#E6E6E6"> }),</span></span>
<span class="line"><span style="color:#6A9955">    // `querySelector` again as `pre` has no role and contains variable content</span></span>
<span class="line"><span style="color:#9CDCFE">    count:</span><span style="color:#C586C0"> await</span><span style="color:#9CDCFE"> canvasElement</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">querySelector</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'pre'</span><span style="color:#E6E6E6">),</span></span>
<span class="line"><span style="color:#E6E6E6">  };</span></span>
<span class="line"><span style="color:#E6E6E6">}</span></span>
<span class="line"></span></code></pre>
<p>This returns an object with our elements:</p>
<pre class="astro-code slack-dark" style="background-color:#222222;color:#E6E6E6; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E6E6E6">{</span></span>
<span class="line"><span style="color:#E6E6E6">  screen: {</span><span style="color:#9CDCFE">object</span><span style="color:#C586C0"> with</span><span style="color:#9CDCFE"> testing</span><span style="color:#D4D4D4">-</span><span style="color:#9CDCFE">library</span><span style="color:#9CDCFE"> query</span><span style="color:#9CDCFE"> methods</span><span style="color:#E6E6E6">},</span></span>
<span class="line"><span style="color:#E6E6E6">  canvasElement: </span><span style="color:#D4D4D4">&#x3C;</span><span style="color:#9CDCFE">the</span><span style="color:#D4D4D4">-</span><span style="color:#9CDCFE">initial</span><span style="color:#D4D4D4">-</span><span style="color:#9CDCFE">html</span><span style="color:#D4D4D4">-</span><span style="color:#9CDCFE">element</span><span style="color:#E6E6E6">,</span><span style="color:#9CDCFE">unchanged</span><span style="color:#D4D4D4">></span><span style="color:#E6E6E6">,</span></span>
<span class="line"><span style="color:#E6E6E6">  container: </span><span style="color:#808080">&#x3C;</span><span style="color:#569CD6">div</span><span style="color:#9CDCFE"> class</span><span style="color:#D4D4D4">=</span><span style="color:#CE9178">"counter"</span><span style="color:#808080">></span><span style="color:#E6E6E6">...</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">div</span><span style="color:#808080">></span><span style="color:#D4D4D4">/</span><span style="color:#E6E6E6">{</span><span style="color:#9CDCFE">and</span><span style="color:#9CDCFE"> query</span><span style="color:#9CDCFE"> methods</span><span style="color:#E6E6E6">},</span></span>
<span class="line"><span style="color:#E6E6E6">  minus: </span><span style="color:#808080">&#x3C;</span><span style="color:#569CD6">button</span><span style="color:#808080">></span><span style="color:#E6E6E6">-</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">button</span><span style="color:#808080">></span><span style="color:#D4D4D4">/</span><span style="color:#E6E6E6">{</span><span style="color:#9CDCFE">and</span><span style="color:#9CDCFE"> query</span><span style="color:#9CDCFE"> methods</span><span style="color:#E6E6E6">},</span></span>
<span class="line"><span style="color:#E6E6E6">  plus: </span><span style="color:#808080">&#x3C;</span><span style="color:#569CD6">button</span><span style="color:#808080">></span><span style="color:#E6E6E6">+</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">button</span><span style="color:#808080">></span><span style="color:#D4D4D4">/</span><span style="color:#E6E6E6">{</span><span style="color:#9CDCFE">and</span><span style="color:#9CDCFE"> query</span><span style="color:#9CDCFE"> methods</span><span style="color:#E6E6E6">},</span></span>
<span class="line"><span style="color:#E6E6E6">  count: </span><span style="color:#808080">&#x3C;</span><span style="color:#569CD6">pre</span><span style="color:#808080">></span><span style="color:#E6E6E6">0</span><span style="color:#808080">&#x3C;/</span><span style="color:#569CD6">pre</span><span style="color:#808080">></span><span style="color:#D4D4D4">/</span><span style="color:#E6E6E6">{</span><span style="color:#9CDCFE">and</span><span style="color:#9CDCFE"> query</span><span style="color:#9CDCFE"> methods</span><span style="color:#E6E6E6">},</span></span>
<span class="line"><span style="color:#E6E6E6">}</span></span>
<span class="line"></span></code></pre>
<h3 id="2-testing-the-initial-rendered-elements">2. Testing the initial rendered elements</h3>
<p>The Counter is a simple component that has no props, so this method just ensures the elements are present and the counter starts at <code>0</code>. <code>ensureElements</code> should be called before interaction tests to ensure the initial state of the component is what is tested.</p>
<p>The <code>elements</code> arg is the object returned from <code>getElements</code>.</p>
<pre class="astro-code slack-dark" style="background-color:#222222;color:#E6E6E6; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#6A9955">/**</span></span>
<span class="line"><span style="color:#6A9955"> * Ensure elements are present and have the correct attributes/content</span></span>
<span class="line"><span style="color:#6A9955"> */</span></span>
<span class="line"><span style="color:#C586C0">export</span><span style="color:#569CD6"> const</span><span style="color:#DCDCAA"> ensureElements</span><span style="color:#D4D4D4"> =</span><span style="color:#569CD6"> async</span><span style="color:#E6E6E6"> (</span><span style="color:#9CDCFE">elements</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">=></span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#569CD6">  const</span><span style="color:#E6E6E6"> { </span><span style="color:#9CDCFE">minus</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">plus</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">count</span><span style="color:#E6E6E6"> } </span><span style="color:#D4D4D4">=</span><span style="color:#9CDCFE"> elements</span><span style="color:#E6E6E6">;</span></span>
<span class="line"><span style="color:#6A9955">  // `.toBeTruthy` ensures the element exists</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#DCDCAA"> expect</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">minus</span><span style="color:#E6E6E6">).</span><span style="color:#DCDCAA">toBeTruthy</span><span style="color:#E6E6E6">();</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#DCDCAA"> expect</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">plus</span><span style="color:#E6E6E6">).</span><span style="color:#DCDCAA">toBeTruthy</span><span style="color:#E6E6E6">();</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#DCDCAA"> expect</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">count</span><span style="color:#E6E6E6">).</span><span style="color:#DCDCAA">toBeTruthy</span><span style="color:#E6E6E6">();</span></span>
<span class="line"><span style="color:#6A9955">  // ensures the count starts at zero</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#DCDCAA"> expect</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">count</span><span style="color:#E6E6E6">).</span><span style="color:#DCDCAA">toHaveTextContent</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'0'</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#E6E6E6">}</span></span>
<span class="line"></span></code></pre>
<h3 id="3-testing-keyboard-navigation">3. Testing keyboard navigation</h3>
<p>For keyboard-only users, we’ll need to ensure the buttons are focusable and in the expected order. We test navigation separate from interactions to keep the testing methods focused on one type of user experience at a time.</p>
<p>The component only has two focus-able elements - which are the buttons.</p>
<pre class="astro-code slack-dark" style="background-color:#222222;color:#E6E6E6; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#6A9955">/**</span></span>
<span class="line"><span style="color:#6A9955"> * Test keyboard interaction</span></span>
<span class="line"><span style="color:#6A9955"> */</span></span>
<span class="line"><span style="color:#C586C0">export</span><span style="color:#569CD6"> const</span><span style="color:#DCDCAA"> keyboardNavigation</span><span style="color:#D4D4D4"> =</span><span style="color:#569CD6"> async</span><span style="color:#E6E6E6"> (</span><span style="color:#9CDCFE">elements</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">=></span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#569CD6">  const</span><span style="color:#E6E6E6"> { </span><span style="color:#9CDCFE">minus</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">plus</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">container</span><span style="color:#E6E6E6"> } </span><span style="color:#D4D4D4">=</span><span style="color:#9CDCFE"> elements</span><span style="color:#E6E6E6">;</span></span>
<span class="line"><span style="color:#6A9955">  // tab within the container</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#9CDCFE"> userEvent</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">tab</span><span style="color:#E6E6E6">({ </span><span style="color:#9CDCFE">focusTrap:</span><span style="color:#9CDCFE"> container</span><span style="color:#E6E6E6"> });</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#DCDCAA"> expect</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">minus</span><span style="color:#E6E6E6">).</span><span style="color:#DCDCAA">toHaveFocus</span><span style="color:#E6E6E6">();</span></span>
<span class="line"><span style="color:#6A9955">  // `pre` is the next element, but it's not focusable</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#9CDCFE"> userEvent</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">tab</span><span style="color:#E6E6E6">({ </span><span style="color:#9CDCFE">focusTrap:</span><span style="color:#9CDCFE"> container</span><span style="color:#E6E6E6"> });</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#DCDCAA"> expect</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">plus</span><span style="color:#E6E6E6">).</span><span style="color:#DCDCAA">toHaveFocus</span><span style="color:#E6E6E6">();</span></span>
<span class="line"><span style="color:#E6E6E6">}</span></span>
<span class="line"></span></code></pre>
<h3 id="4-testing-keyboard-interactions">4. Testing keyboard interactions</h3>
<p>For testing the interaction of the buttons, we’ll be adding or subtracting to the number in <code>pre</code>. We cannot ensure the order the testing methods will be used, which means <code>elements.count</code> might not be <code>0</code>. This test method will start by getting whatever number is in <code>elements.count</code> and use that number to test the expected addition or subtraction result.</p>
<pre class="astro-code slack-dark" style="background-color:#222222;color:#E6E6E6; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#6A9955">/**</span></span>
<span class="line"><span style="color:#6A9955"> * Test keyboard interactions</span></span>
<span class="line"><span style="color:#6A9955"> */</span></span>
<span class="line"><span style="color:#C586C0">export</span><span style="color:#569CD6"> const</span><span style="color:#DCDCAA"> keyboardInteraction</span><span style="color:#D4D4D4"> =</span><span style="color:#569CD6"> async</span><span style="color:#E6E6E6"> (</span><span style="color:#9CDCFE">elements</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">=></span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#569CD6">  const</span><span style="color:#E6E6E6"> { </span><span style="color:#9CDCFE">minus</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">plus</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">count</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">container</span><span style="color:#E6E6E6"> } </span><span style="color:#D4D4D4">=</span><span style="color:#9CDCFE"> elements</span><span style="color:#E6E6E6">;</span></span>
<span class="line"><span style="color:#6A9955">  // could be any number</span></span>
<span class="line"><span style="color:#569CD6">  const</span><span style="color:#9CDCFE"> initCount</span><span style="color:#D4D4D4"> =</span><span style="color:#DCDCAA"> parseInt</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">count</span><span style="color:#E6E6E6">.</span><span style="color:#9CDCFE">textContent</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#6A9955">  // navigation unimportant here, so we'll just focus on the button</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#9CDCFE"> plus</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">focus</span><span style="color:#E6E6E6">();</span></span>
<span class="line"><span style="color:#6A9955">  // with the `plus` button in focus, hitting `enter` should increment</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#9CDCFE"> userEvent</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">keyboard</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'{enter}'</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#DCDCAA"> expect</span><span style="color:#E6E6E6">(</span><span style="color:#DCDCAA">parseInt</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">count</span><span style="color:#E6E6E6">.</span><span style="color:#9CDCFE">textContent</span><span style="color:#E6E6E6">)).</span><span style="color:#DCDCAA">toBe</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">initCount</span><span style="color:#D4D4D4"> +</span><span style="color:#B5CEA8"> 1</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#9CDCFE"> userEvent</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">keyboard</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'{enter}'</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#DCDCAA"> expect</span><span style="color:#E6E6E6">(</span><span style="color:#DCDCAA">parseInt</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">count</span><span style="color:#E6E6E6">.</span><span style="color:#9CDCFE">textContent</span><span style="color:#E6E6E6">)).</span><span style="color:#DCDCAA">toBe</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">initCount</span><span style="color:#D4D4D4"> +</span><span style="color:#B5CEA8"> 2</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#9CDCFE"> minus</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">focus</span><span style="color:#E6E6E6">();</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#9CDCFE"> userEvent</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">keyboard</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'{enter}'</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#DCDCAA"> expect</span><span style="color:#E6E6E6">(</span><span style="color:#DCDCAA">parseInt</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">count</span><span style="color:#E6E6E6">.</span><span style="color:#9CDCFE">textContent</span><span style="color:#E6E6E6">)).</span><span style="color:#DCDCAA">toBe</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">initCount</span><span style="color:#D4D4D4"> +</span><span style="color:#B5CEA8"> 1</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#9CDCFE"> userEvent</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">keyboard</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'{enter}'</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#DCDCAA"> expect</span><span style="color:#E6E6E6">(</span><span style="color:#DCDCAA">parseInt</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">count</span><span style="color:#E6E6E6">.</span><span style="color:#9CDCFE">textContent</span><span style="color:#E6E6E6">)).</span><span style="color:#DCDCAA">toBe</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">initCount</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#9CDCFE"> userEvent</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">keyboard</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'{enter}'</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#DCDCAA"> expect</span><span style="color:#E6E6E6">(</span><span style="color:#DCDCAA">parseInt</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">count</span><span style="color:#E6E6E6">.</span><span style="color:#9CDCFE">textContent</span><span style="color:#E6E6E6">)).</span><span style="color:#DCDCAA">toBe</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">initCount</span><span style="color:#D4D4D4"> -</span><span style="color:#B5CEA8"> 1</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#6A9955">  // reset user focus to nothing</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#9CDCFE"> minus</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">blur</span><span style="color:#E6E6E6">();</span></span>
<span class="line"><span style="color:#E6E6E6">}</span></span>
<span class="line"></span></code></pre>
<h3 id="5-testing-mouse-interactions">5. Testing mouse interactions</h3>
<p>Same as keyboard interactions, but with mouse clicks instead of keyboard events.</p>
<pre class="astro-code slack-dark" style="background-color:#222222;color:#E6E6E6; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#6A9955">/**</span></span>
<span class="line"><span style="color:#6A9955"> * Test mouse interaction</span></span>
<span class="line"><span style="color:#6A9955"> */</span></span>
<span class="line"><span style="color:#C586C0">export</span><span style="color:#569CD6"> const</span><span style="color:#DCDCAA"> mouseInteraction</span><span style="color:#D4D4D4"> =</span><span style="color:#569CD6"> async</span><span style="color:#E6E6E6"> (</span><span style="color:#9CDCFE">elements</span><span style="color:#E6E6E6">) </span><span style="color:#569CD6">=></span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#569CD6">  const</span><span style="color:#E6E6E6"> { </span><span style="color:#9CDCFE">minus</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">plus</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">count</span><span style="color:#E6E6E6"> } </span><span style="color:#D4D4D4">=</span><span style="color:#9CDCFE"> elements</span><span style="color:#E6E6E6">;</span></span>
<span class="line"><span style="color:#569CD6">  const</span><span style="color:#9CDCFE"> initCount</span><span style="color:#D4D4D4"> =</span><span style="color:#DCDCAA"> parseInt</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">count</span><span style="color:#E6E6E6">.</span><span style="color:#9CDCFE">textContent</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#9CDCFE"> userEvent</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">click</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">plus</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#DCDCAA"> expect</span><span style="color:#E6E6E6">(</span><span style="color:#DCDCAA">parseInt</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">count</span><span style="color:#E6E6E6">.</span><span style="color:#9CDCFE">textContent</span><span style="color:#E6E6E6">)).</span><span style="color:#DCDCAA">toBe</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">initCount</span><span style="color:#D4D4D4"> +</span><span style="color:#B5CEA8"> 1</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#9CDCFE"> userEvent</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">click</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">plus</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#DCDCAA"> expect</span><span style="color:#E6E6E6">(</span><span style="color:#DCDCAA">parseInt</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">count</span><span style="color:#E6E6E6">.</span><span style="color:#9CDCFE">textContent</span><span style="color:#E6E6E6">)).</span><span style="color:#DCDCAA">toBe</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">initCount</span><span style="color:#D4D4D4"> +</span><span style="color:#B5CEA8"> 2</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#9CDCFE"> userEvent</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">click</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">minus</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#DCDCAA"> expect</span><span style="color:#E6E6E6">(</span><span style="color:#DCDCAA">parseInt</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">count</span><span style="color:#E6E6E6">.</span><span style="color:#9CDCFE">textContent</span><span style="color:#E6E6E6">)).</span><span style="color:#DCDCAA">toBe</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">initCount</span><span style="color:#D4D4D4"> +</span><span style="color:#B5CEA8"> 1</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#9CDCFE"> userEvent</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">click</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">minus</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#DCDCAA"> expect</span><span style="color:#E6E6E6">(</span><span style="color:#DCDCAA">parseInt</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">count</span><span style="color:#E6E6E6">.</span><span style="color:#9CDCFE">textContent</span><span style="color:#E6E6E6">)).</span><span style="color:#DCDCAA">toBe</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">initCount</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#9CDCFE"> userEvent</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">click</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">minus</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#DCDCAA"> expect</span><span style="color:#E6E6E6">(</span><span style="color:#DCDCAA">parseInt</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">count</span><span style="color:#E6E6E6">.</span><span style="color:#9CDCFE">textContent</span><span style="color:#E6E6E6">)).</span><span style="color:#DCDCAA">toBe</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">initCount</span><span style="color:#D4D4D4"> -</span><span style="color:#B5CEA8"> 1</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#6A9955">  // reset user focus</span></span>
<span class="line"><span style="color:#C586C0">  await</span><span style="color:#9CDCFE"> minus</span><span style="color:#E6E6E6">.</span><span style="color:#DCDCAA">blur</span><span style="color:#E6E6E6">();</span></span>
<span class="line"><span style="color:#E6E6E6">}</span></span>
<span class="line"></span></code></pre>
<h2 id="using-the-shared-tests-in-storybook">Using the shared tests in Storybook</h2>
<p>Now that we have our shared tests, we can use them in Storybook. (see <a href="/blahg/shared-storybook-tests/">part 1</a>). Below is the React story file, see <a href="https://github.com/storydocker/storydocker-examples/tree/main/experimental/astro-framework-multiple/.framework-storybooks/stories">the full set of framework-specific stories here</a>. The test methods are broken out into <code>step</code> functions for legibility in the Storybook UI, but they are not required.</p>
<pre class="astro-code slack-dark" style="background-color:#222222;color:#E6E6E6; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#6A9955">// ReactCounter.stories.js</span></span>
<span class="line"><span style="color:#C586C0">import</span><span style="color:#E6E6E6"> { </span><span style="color:#9CDCFE">ReactCounter</span><span style="color:#E6E6E6"> } </span><span style="color:#C586C0">from</span><span style="color:#CE9178"> '../../src/components/ReactCounter'</span><span style="color:#E6E6E6">;</span></span>
<span class="line"><span style="color:#C586C0">import</span><span style="color:#E6E6E6"> { </span><span style="color:#9CDCFE">getElements</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">ensureElements</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">mouseInteraction</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">keyboardNavigation</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">keyboardInteraction</span><span style="color:#E6E6E6"> } </span><span style="color:#C586C0">from</span><span style="color:#CE9178"> '../../src/components/tests/counter.shared-spec'</span><span style="color:#E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C586C0">export</span><span style="color:#C586C0"> default</span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#9CDCFE">  title:</span><span style="color:#CE9178"> 'React'</span><span style="color:#E6E6E6">,</span></span>
<span class="line"><span style="color:#9CDCFE">  component:</span><span style="color:#9CDCFE"> ReactCounter</span><span style="color:#E6E6E6">,</span></span>
<span class="line"><span style="color:#E6E6E6">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C586C0">export</span><span style="color:#569CD6"> const</span><span style="color:#9CDCFE"> React</span><span style="color:#D4D4D4"> =</span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#DCDCAA">  play</span><span style="color:#9CDCFE">:</span><span style="color:#569CD6"> async</span><span style="color:#E6E6E6"> ({ </span><span style="color:#9CDCFE">args</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">canvasElement</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">step</span><span style="color:#E6E6E6"> }) </span><span style="color:#569CD6">=></span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#569CD6">    const</span><span style="color:#9CDCFE"> elements</span><span style="color:#D4D4D4"> =</span><span style="color:#C586C0"> await</span><span style="color:#DCDCAA"> getElements</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">canvasElement</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#DCDCAA">    step</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'react tests'</span><span style="color:#E6E6E6">, </span><span style="color:#569CD6">async</span><span style="color:#E6E6E6"> () </span><span style="color:#569CD6">=></span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#C586C0">      await</span><span style="color:#DCDCAA"> step</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'ensure elements'</span><span style="color:#E6E6E6">, </span><span style="color:#569CD6">async</span><span style="color:#E6E6E6"> () </span><span style="color:#569CD6">=></span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#C586C0">        await</span><span style="color:#DCDCAA"> ensureElements</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">elements</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#E6E6E6">      });</span></span>
<span class="line"><span style="color:#C586C0">      await</span><span style="color:#DCDCAA"> step</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'mouse interaction'</span><span style="color:#E6E6E6">, </span><span style="color:#569CD6">async</span><span style="color:#E6E6E6"> () </span><span style="color:#569CD6">=></span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#C586C0">        await</span><span style="color:#DCDCAA"> mouseInteraction</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">elements</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#E6E6E6">      });</span></span>
<span class="line"><span style="color:#C586C0">      await</span><span style="color:#DCDCAA"> step</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'keyboard navigation'</span><span style="color:#E6E6E6">, </span><span style="color:#569CD6">async</span><span style="color:#E6E6E6"> () </span><span style="color:#569CD6">=></span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#C586C0">        await</span><span style="color:#DCDCAA"> keyboardNavigation</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">elements</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#E6E6E6">      });</span></span>
<span class="line"><span style="color:#C586C0">      await</span><span style="color:#DCDCAA"> step</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'keyboard interaction'</span><span style="color:#E6E6E6">, </span><span style="color:#569CD6">async</span><span style="color:#E6E6E6"> () </span><span style="color:#569CD6">=></span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#C586C0">        await</span><span style="color:#DCDCAA"> keyboardInteraction</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">elements</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#E6E6E6">      });</span></span>
<span class="line"><span style="color:#E6E6E6">    });</span></span>
<span class="line"><span style="color:#E6E6E6">  },</span></span>
<span class="line"><span style="color:#E6E6E6">};</span></span>
<span class="line"></span></code></pre>
<h2 id="using-the-shared-tests-in-vitest-unit-tests">Using the shared tests in Vitest unit tests</h2>
<p>They also drop-in to our unit tests. (see <a href="/blahg/sharing-tests-between-vitest-and-storybook/">part 3</a>). Below is the React unit test file, see <a href="https://github.com/storydocker/storydocker-examples/tree/main/experimental/astro-framework-multiple/src/components/tests">the full set of framework-specific unit tests here</a>. The magic here is in the <code>render</code> function. Each framework has a different one, but once Vitest renders it, the resulting output of all frameworks is understood by the shared tests.</p>
<p><em>note:</em> The separate <code>it</code> functions are required for now for React, which was having some issues isolating the user interactions when they are all ran together. The <code>it</code> functions are not required for all frameworks, but since they give legibility anyway, we’ll keep them.</p>
<pre class="astro-code slack-dark" style="background-color:#222222;color:#E6E6E6; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#6A9955">// Vue.spec.tsx</span></span>
<span class="line"><span style="color:#C586C0">import</span><span style="color:#E6E6E6"> { </span><span style="color:#9CDCFE">render</span><span style="color:#E6E6E6"> } </span><span style="color:#C586C0">from</span><span style="color:#CE9178"> '@testing-library/vue'</span><span style="color:#E6E6E6">;</span></span>
<span class="line"><span style="color:#C586C0">import</span><span style="color:#E6E6E6"> { </span><span style="color:#9CDCFE">describe</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">it</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">assert</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">expect</span><span style="color:#E6E6E6"> } </span><span style="color:#C586C0">from</span><span style="color:#CE9178"> 'vitest'</span><span style="color:#E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C586C0">import</span><span style="color:#9CDCFE"> VueCounter</span><span style="color:#C586C0"> from</span><span style="color:#CE9178"> '@/components/VueCounter.vue'</span><span style="color:#E6E6E6">;</span></span>
<span class="line"><span style="color:#C586C0">import</span><span style="color:#E6E6E6"> { </span><span style="color:#9CDCFE">getElements</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">ensureElements</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">mouseInteraction</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">keyboardNavigation</span><span style="color:#E6E6E6">, </span><span style="color:#9CDCFE">keyboardInteraction</span><span style="color:#E6E6E6"> } </span><span style="color:#C586C0">from</span><span style="color:#CE9178"> '@/components/tests/counter.shared-spec'</span><span style="color:#E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DCDCAA">describe</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'Vue'</span><span style="color:#E6E6E6">, () </span><span style="color:#569CD6">=></span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#DCDCAA">  describe</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'Counter'</span><span style="color:#E6E6E6">, () </span><span style="color:#569CD6">=></span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#DCDCAA">    it</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'ensure elements'</span><span style="color:#E6E6E6">, </span><span style="color:#569CD6">async</span><span style="color:#E6E6E6"> () </span><span style="color:#569CD6">=></span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#569CD6">      const</span><span style="color:#9CDCFE"> rendered</span><span style="color:#D4D4D4"> =</span><span style="color:#DCDCAA"> render</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">VueCounter</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#569CD6">      const</span><span style="color:#9CDCFE"> elements</span><span style="color:#D4D4D4"> =</span><span style="color:#C586C0"> await</span><span style="color:#DCDCAA"> getElements</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">rendered</span><span style="color:#E6E6E6">.</span><span style="color:#9CDCFE">container</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">      await</span><span style="color:#DCDCAA"> ensureElements</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">elements</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#E6E6E6">    });</span></span>
<span class="line"><span style="color:#DCDCAA">    it</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'mouse interaction'</span><span style="color:#E6E6E6">, </span><span style="color:#569CD6">async</span><span style="color:#E6E6E6"> () </span><span style="color:#569CD6">=></span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#569CD6">      const</span><span style="color:#9CDCFE"> rendered</span><span style="color:#D4D4D4"> =</span><span style="color:#DCDCAA"> render</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">VueCounter</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#569CD6">      const</span><span style="color:#9CDCFE"> elements</span><span style="color:#D4D4D4"> =</span><span style="color:#C586C0"> await</span><span style="color:#DCDCAA"> getElements</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">rendered</span><span style="color:#E6E6E6">.</span><span style="color:#9CDCFE">container</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">      await</span><span style="color:#DCDCAA"> mouseInteraction</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">elements</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#E6E6E6">    });</span></span>
<span class="line"><span style="color:#DCDCAA">    it</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'keyboard navigation'</span><span style="color:#E6E6E6">, </span><span style="color:#569CD6">async</span><span style="color:#E6E6E6"> () </span><span style="color:#569CD6">=></span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#569CD6">      const</span><span style="color:#9CDCFE"> rendered</span><span style="color:#D4D4D4"> =</span><span style="color:#DCDCAA"> render</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">VueCounter</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#569CD6">      const</span><span style="color:#9CDCFE"> elements</span><span style="color:#D4D4D4"> =</span><span style="color:#C586C0"> await</span><span style="color:#DCDCAA"> getElements</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">rendered</span><span style="color:#E6E6E6">.</span><span style="color:#9CDCFE">container</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">      await</span><span style="color:#DCDCAA"> keyboardNavigation</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">elements</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#E6E6E6">    });</span></span>
<span class="line"><span style="color:#DCDCAA">    it</span><span style="color:#E6E6E6">(</span><span style="color:#CE9178">'keyboard interaction'</span><span style="color:#E6E6E6">, </span><span style="color:#569CD6">async</span><span style="color:#E6E6E6"> () </span><span style="color:#569CD6">=></span><span style="color:#E6E6E6"> {</span></span>
<span class="line"><span style="color:#569CD6">      const</span><span style="color:#9CDCFE"> rendered</span><span style="color:#D4D4D4"> =</span><span style="color:#DCDCAA"> render</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">VueCounter</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#569CD6">      const</span><span style="color:#9CDCFE"> elements</span><span style="color:#D4D4D4"> =</span><span style="color:#C586C0"> await</span><span style="color:#DCDCAA"> getElements</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">rendered</span><span style="color:#E6E6E6">.</span><span style="color:#9CDCFE">container</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#C586C0">      await</span><span style="color:#DCDCAA"> keyboardInteraction</span><span style="color:#E6E6E6">(</span><span style="color:#9CDCFE">elements</span><span style="color:#E6E6E6">);</span></span>
<span class="line"><span style="color:#E6E6E6">    });</span></span>
<span class="line"><span style="color:#E6E6E6">  });</span></span>
<span class="line"><span style="color:#E6E6E6">})</span></span>
<span class="line"></span></code></pre>
<h2 id="wrapping-up">Wrapping up</h2>
<p>Writing sharable user-experience-based tests for your UI is really about planning for the future.</p>
<p>The NewHotness™ UI framework is being built right now and in two years that React component you put your soul into is going to be deleted in lieu of the shiny thing. That doesn’t mean your UX needs to change … or your Design … or your tests. Just do the facelift next time.</p>
<p><em>Efficiency in all things, and productivity will follow.</em></p> </div> </article>  </main> <footer data-astro-cid-sz7xmlte style="--navBorder: #ffd273;"> <nav data-astro-cid-sz7xmlte style="--navBorder: #ffd273;"> <a href="/" data-astro-cid-sz7xmlte style="--navBorder: #ffd273;">home</a> <a href="/whoami" data-astro-cid-sz7xmlte style="--navBorder: #ffd273;">whoami</a> <a href="/blahg" data-astro-cid-sz7xmlte style="--navBorder: #ffd273;">blahg</a> <a href="/resume" data-astro-cid-sz7xmlte style="--navBorder: #ffd273;">resume</a> <a href="/rss.xml" target="_blank" data-astro-cid-sz7xmlte style="--navBorder: #ffd273;">rss feed</a> </nav> <p data-astro-cid-sz7xmlte style="--navBorder: #ffd273;">&copy; 2001-2024&nbsp;Scott Nath All rights reserved.</p> <div data-astro-cid-mtzrixcv style="--navBorder: #ffd273;"> <p data-astro-cid-mtzrixcv style="--navBorder: #ffd273;">CS.Sjoy.lol <a href="https://cs.sjoy.lol" data-astro-cid-mtzrixcv style="--navBorder: #ffd273;">webring</a></p> <div data-astro-cid-mtzrixcv style="--navBorder: #ffd273;"> <a href="https://webri.ng/webring/cssjoy/previous?via=https://scottnath.com" aria-label="previous site" data-astro-cid-mtzrixcv style="--navBorder: #ffd273;">← Prev</a> <a href="https://webri.ng/webring/cssjoy/random?via=https://scottnath.com" aria-label="random site" data-astro-cid-mtzrixcv style="--navBorder: #ffd273;">🎲</a> <a href="https://webri.ng/webring/cssjoy/next?via=https://scottnath.com" aria-label="next site" data-astro-cid-mtzrixcv style="--navBorder: #ffd273;">Next →</a> </div> </div>  <a href="/" class="you-still-here" title="You're still here? Go Home" data-astro-cid-sz7xmlte style="--navBorder: #ffd273;"><img src="/ferris-end-scene.avif" loading="lazy" width="381" height="177" alt="You're still here? (Screen shot from Ferris Bueller's Day Off)" data-astro-cid-sz7xmlte style="--navBorder: #ffd273;"></a> </footer>  </body></html>